apply plugin: 'java'
apply plugin: 'findbugs'
apply plugin: 'jacoco'

sourceCompatibility = '1.8'
targetCompatibility = '1.8'

[compileJava, compileTestJava]*.options*.encoding = 'utf-8'

repositories {
    jcenter()
}

dependencies {
    compile 'org.ow2.asm:asm:5.1'
    compile 'org.mongodb:mongo-java-driver:3.4.2'

    testCompile 'junit:junit:4.12'
    testCompile 'org.hamcrest:hamcrest-all:1.3'
}

jar{
    manifest{
        attributes 'Implementation-Title': 'Chabudai'
        attributes 'Implementation-Version': 1.0
        attributes 'Main-Class': 'com.github.sufbo.Main'
    }
    from configurations.compile.collect { it.isDirectory()? it: zipTree(it) }
}

jacoco{
    toolVersion = '0.7.9'
}

jacocoTestReport{
    reports {
        xml.enabled  = true
        html.enabled = true
    }
}

findbugs{
    ignoreFailures = true
}

test.doLast{
    tasks.jacocoTestReport.execute()
}

tasks.withType(FindBugs) {
    reports {
        xml.enabled = false
        html.enabled = true
    }
}
